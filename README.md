# ModestProposal

An HTTP Toolbox (Requires Swift 1.2)

#### Features
* URL building
* Request building
* Basic authentication
* Response validation

#### URL Building

    let baseURL = NSURL(string: "http://test.com")!

    // http://test.com/login
	let loginURL = baseURL.relativeToPath("/login")

    // http://test.com/data?id=100&page=3
	let dataURL = baseURL.relativeToPath("/data", parameters: ["id": "100", "page": "3"])

#### Request building

    let baseRequest = NSURLRequest(URL: baseURL)

    // HTTPBody will be set to parameters, content type will be "application/x-www-form-urlencoded"
    // and length will be set to match the size of the data generated by parameters
    let loginRequest = baseRequest.POST(path: "/login", parameters: ["id": "100", "page": "3"])
	loginRequest["Custom-Header"] = "Custom value"

    // HTTPBody will be set to JSON data, content type will be "application/json"
    // and length will be set appropriately
    let updateRequest = baseRequest.PUT(path: "/update", JSONObject: ["test": 100])

    // HTTPBody will be set to data, content type will be "application/octet-stream"
    // and length will be set to the length of the supplied data
    let data = NSData(contentsOfFile: "file")
    let dataRequest = baseRequest.POST(path: "/data", body: data)

#### Basic authentication

    let baseRequest = NSURLRequest(URL: baseURL)
    let loginRequest = baseRequest.POST(path: "/login")
    loginRequest.basicAuthorization(username: "test", password: "test")

#### Response validation

    let response = // NSURLResponse from a request
    let builder = ValidatorBuilder()
	
	// Add rules that are executed in order
	builder.valid(when: response.isHTTP, otherwise: NSError(domain, "MyDomain", code: kErrorCode, userInfo: nil))
	builder.valid(when: response.matchesStatuses([HTTPStatusSuccessful], otherwise: NSError(domain, "MyDomain", code: kErrorCode, userInfo: nil))
	builder.valid(when: response["Custom-Header"] == "Custom value", otherwise: NSError(domain, "MyDomain", code: kErrorCode, userInfo: nil))
	
	let validator = builder.build()
	
	if let error = validator.validate() {
		println(error)
	} else {
		println("Valid!")
	}
